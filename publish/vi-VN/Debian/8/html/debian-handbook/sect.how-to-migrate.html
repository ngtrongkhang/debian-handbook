<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>3.2. Làm thể nào để di cư</title><meta name="generator" content="publican v4.3.2"/><meta name="keywords" content="Cài đặt hiện thời, Tái sử dụng, Di cư"/><link rel="prev" href="existing-setup.html" title="Chương 3. Phân tích các cài đặt hiện thời và quá trình di cư"/><link rel="next" href="installation.html" title="Chương 4. Installation"/><link xmlns="" rel="canonical" href="https://debian-handbook.info/browse/vi-VN/stable/sect.how-to-migrate.html"/></head><body onLoad="initSwitchery(); jQuery(&quot;#poptoc&quot;).load('index.html .toc:eq(0)'); jQuery('.programlisting').each(function(i, block){hljs.highlightBlock(block);});" onClick="hide('poptoc');"><header><div id="banner"><a href="http://debian-handbook.info/get/"><span class="text">Download the ebook</span></a></div><ul class="docnav top"><li class="previous"><a accesskey="p" href="existing-setup.html"><strong>Trước đó</strong></a></li><li class="home" onClick="work=1;showhide('poptoc');">Sổ tay Quản trị Debian</li><li class="next"><a accesskey="n" href="installation.html"><strong>Kế tiếp</strong></a></li></ul></header><div id="poptoc" class="hidden"> </div><section class="section" id="sect.how-to-migrate"><div class="titlepage"><div><div><h2 class="title"><a xmlns="" id="sect.how-to-migrate"/>3.2. Làm thể nào để di cư</h2></div></div></div>
		
		 <a id="id-1.6.5.2" class="indexterm"></a>
		 <p>
			Nhằm đảm bảo các service hoạt động liên tục, mỗi quá trình di cư máy tính cần được lên kịch bản và thực hiện theo kế hoạch. Đây là nguyên tắc áp dụng cho khi sử dụng bất kỳ hệ điều hành nào.
		</p>
		 <section class="section" id="id-1.6.5.4"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="id-1.6.5.4"/>3.2.1. Dò tìm và Định danh cách dịch vụ</h3></div></div></div>
			
			 <p>
				Nghe thì nó có vẻ đơn giản, sau đây là các bước cần thiết. Một quản trị viên thực thụ cần biết chính xác vai trò chính của từng server, nhưng các vai trò có thể thay đổi và đôi khi người dùng kinh nghiệm có thể đã cài đặt các dịch vụ không chính thống. Việc biết được sự tồn tại của chúng ít ra giúp cho bạn quyết định làm gì với nó hơn là xóa một cách tùy tiện.
			</p>
			 <p>
				Vì mục đích này, nó thực sự sáng suốt để thông báo tới người dùng của bạn trong dự án trước khi di cư server. Để họ tham gia vào dự án, nó có thể hữu ích cho việc cài đặt các phần mềm phổ biến trên desktop của họ trước khi di cư, những cái mà họ có thể gặp lần nữa sau khi chuyển sang Debian; Libre Office và bộ phần mềm Mozilla là một số ví dụ điển hình.
			</p>
			 <section class="section" id="id-1.6.5.4.4"><div class="titlepage"><div><div><h4 class="title"><a xmlns="" id="id-1.6.5.4.4"/>3.2.1.1. Mạng và Tiến trình</h4></div></div></div>
				
				 <a id="id-1.6.5.4.4.2" class="indexterm"></a>
				 <p>
					Chương trình <span class="command"><strong>nmap</strong></span> (với gói cùng tên) sẽ nhanh chóng định danh dịch vụ mạng được duy trì bởi một máy tính đã kết nối mạng mà không cần đăng nhập vào nó. Đơn giản chỉ là gọi lệnh sau đây trên một máy tính khác cùng mạng đã kết nối:
				</p>
				 
<pre class="screen">
<code class="computeroutput">$ </code><strong class="userinput"><code>nmap mirwiz</code></strong>
<code class="computeroutput">Starting Nmap 6.47 ( http://nmap.org ) at 2015-03-24 11:34 CET Nmap scan report for mirwiz (192.168.1.104) Host is up (0.0037s latency). Not shown: 999 closed ports PORT STATE SERVICE 22/tcp open ssh Nmap done: 1 IP address (1 host up) scanned in 0.13 seconds</code></pre>
				 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>THAY THẾ</em></span> Sử dụng <span class="command"><strong>netstat</strong></span> để tìm danh sách các dịch vụ khả dụng</strong></p></div></div></div> 
				 <p>
					Trên một máy tính Linux, lệnh <span class="command"><strong>netstat -tupan</strong></span> sẽ hiển thị danh sách phiên làm việc TCP đang active hoặc pending, như là các UDP ports lắng nghe bởi các chương trình đang chạy. Điều này tạo điều kiện định danh các dịch vụ được quảng bá qua mạng.
				</p>
				 </div> <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>TIẾN TỚI</em></span> IPv6</strong></p></div></div></div> 
				 <p>
					Một vài lệnh về mạng có thể làm việc với IPv4 (thường là mặc đinh) or IPv6. Chúng bao gồm lệnh <span class="command"><strong>nmap</strong></span> và <span class="command"><strong>netstat</strong></span>, nhưng một số khác, chẳng hạn <span class="command"><strong>route</strong></span> hoặc <span class="command"><strong>ip</strong></span>. Các quy ước hành vi này được kích hoạt bởi tùy chọn <em class="parameter"><code>-6</code></em>.
				</p>
				 </div> <p>
					Nếu như server là một máy tính Unix cung cấp cho người dùng tiện ích shell, nó thực sự thú vị để xác định các tiến trình được thực thi dưới background trong sự vắng mặt chủ sở hữu chúng. Lệnh <span class="command"><strong>ps auxw</strong></span> hiển thị một danh sách của các tiến trình với định danh người dùng của chúng. Bằng sự xem xét các thông tin phản hồi từ đầu ra của lệnh <span class="command"><strong>who</strong></span>, chúng ta sẽ thấy một danh sách các người dùng và thời điểm đã đăng nhập, qua đó có thể xác định kẻ mạo danh hoặc các dịch vụ không xác định hoặc các chương trình đang chạy dưới nền. Việc tìm kiếm ở <code class="filename">crontabs</code> (bảng danh sách các hành động được lập lịch tự động thực hiện bởi người dùng) thường sẽ cung cấp các thông tin đang quan tâm trên về các chức năng được thực hiện bởi máy chủ (giải thích đầy đủ của <span class="command"><strong>cron</strong></span> xem thêm tại <a class="xref" href="sect.task-scheduling-cron-atd.html" title="9.7. Scheduling Tasks with cron and atd">Phần 9.7, “Scheduling Tasks with <span class="command"><strong>cron</strong></span> and <span class="command"><strong>atd</strong></span>”</a>).
				</p>
				 <p>
					Trong bất cứ trường hợp nào, nó cần thiết để sao lưu các servers của bạn: điều này cho phép khôi phục thông tin theo hoàn cảnh cụ thể, khi người dùng báo cáo các vấn đề trong quá trình di cư.
				</p>

			</section>

		</section>
		 <section class="section" id="id-1.6.5.5"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="id-1.6.5.5"/>3.2.2. Quá trình sao lưu cấu hình</h3></div></div></div>
			
			 <p>
				Nó là cách khôn ngoan để lưu giữ các cấu hình của bất kỳ dịch vụ xác định nào phục vụ cho việc cài đặt tương tự trên server cập nhật. Tối thiểu là việc tạo ra các bản sao của các tệp tin cấu hình.
			</p>
			 <p>
				Với các máy tính Unix, các tệp tin cấu hình thường được tìm thấy trong <code class="filename">/etc/</code>, nhưng chúng có thể được lưu trong một thư mục con của <code class="filename">/usr/local/</code>. Đây là trường hợp khi một chương trình đã cài đặt từ mã nguồn, thay vì một gói. Trong một số trường hợp, người ta cũng có thể tìm thấy chúng trong <code class="filename">/opt/</code>.
			</p>
			 <p>
				Với các service quản lý dữ liệu (như databases chẳng hạn), thường đưọc khuyến cáo export dữ liệu sang một định dạng chuẩn sao cho dễ dàng được import bởi các chương trình mới. Chẳng hạn một định dạng hay dùng dạng văn bản hay tài liệu; nó có thể chấp nhận được, ví dụ như: một tập tin SQL hay một tập tin LDIF dành cho LDAP server.
			</p>
			 <div class="figure" id="id-1.6.5.5.5"><a id="id-1.6.5.5.5"/><p class="title"><strong>Hình 3.2. Sao lưu cơ sở dữ liệu</strong></p><div class="figure-contents">
				
				 <div class="mediaobject"><img src="images/existing-setup-2.png" alt="Sao lưu cơ sở dữ liệu"/></div>

			</div></div>
			 <p>
				Rõ ràng là từng phần mềm máy chủ là khác nhau, và không thể để mô tả toàn bộ các trường hợp một cách chi tiết. Để xác định khả năng export của các thành phần (hay nó cũng có khả năng tái import) cần so sánh tài liệu đã có với phần mềm mới và những điều này sẽ yêu cầu thực hiện bằng tay. Trong cuốn sách này sẽ làm sáng tỏ các cấu hình của các chương trình chính trên Linux server.
			</p>

		</section>
		 <section class="section" id="id-1.6.5.6"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="id-1.6.5.6"/>3.2.3. Tiếp quản các máy chủ Debian hiện có</h3></div></div></div>
			
			 <a id="id-1.6.5.6.2" class="indexterm"></a>
			 <a id="id-1.6.5.6.3" class="indexterm"></a>
			 <a id="id-1.6.5.6.4" class="indexterm"></a>
			 <p>
				Để đạt hiểu quả trong việc tiếp quản các thành phần đang nắm giữ của nó, cần một ai đó có thể phân tích một máy chủ thực sự đang chạy với Debian.
			</p>
			 <p>
				Tệp tin đầu tiên nên xem là <code class="filename">/etc/debian_version</code>, nó thường chứa phiên bản của hệ thống Debian hiện tại (nó là một phần của gói <span class="emphasis"><em>base-files</em></span>). Nếu nó chỉ rõ <code class="literal"><em class="replaceable">codename</em>/sid</code>, điều đó có nghĩa là hệ thống đã được cập nhật với các gói tin kéo về từ một bản phân phối đang phát triển (hay một bản đang thử nghiệm hoặc không chính thức).
			</p>
			 <p>
				chương trình <span class="command"><strong>apt-show-versions</strong></span> (với gói Debian cùng tên) kiểm tra danh sách các gói tin đã cài đặt và xác định phiên bản hiện có. <span class="command"><strong>aptitude</strong></span> cũng có thể được sử dụng cho các nhiệm vụ trên, kể cả trong một số các hệ thống kiểu cũ.
			</p>
			 <p>
				Lướt qua tệp tin <code class="filename">/etc/apt/sources.list</code> (và thư mục <code class="filename">/etc/apt/sources.list.d/</code>) có thể thấy các gói tin Debian đã cài đặt đến từ đâu.
			</p>
			 <p>
				Tệp tin <code class="filename">sources.list</code> thường chỉ ra các thông tin tốt: phần lớn được quản trị viên năm giữ, một số ít chú thích, danh sách của các nguồn APT đã được sử dụng. Nhưng bạn không nên bỏ quên các nguồn đã sử dụng trong quá khứ mà có thể đã bị xóa, và các gói mặc định tải về từ Internet được cài đặt bằng tay (với lệnh <span class="command"><strong>dpkg</strong></span>). Trong trường hợp này, máy tính đang bị nhầm lẫn vào sự xuất hiện của nó trong kho phần mềm chuẩn của Debian. Điều này lý giải tại sao bạn nên....
			</p>
			 <p>
				Tương tự, việc phân tích nội dung thư mục <code class="filename">/usr/local/</code> cũng đáng quan tâm, cái mà mục đích của nó là chứa các chương trình đã biên dịch và cài đặt bình thường. Danh sách các phần mềm đã cài đặt theo kiểu này có thể để đào tạo, từ đây đặt ra các câu hỏi về lý do tại sao không sử dụng các gói của Debian nếu như nó tồn tại.
			</p>
			 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>QUICK LOOK</em></span> <span class="pkg pkg">cruft</span></strong></p></div></div></div> 
			 <p>
				Gói <span class="pkg pkg">cruft</span> được xây dựng để liệt kê các tập tin khả dụng mà không thuộc bất kỳ gói tin nào. Nó có một vài bộ lọc (ít nhiều có hữu hiệu, và ít nhiều được cập nhật) để tránh trả về một số tệp tin chính thống (các tệp tin sinh ra bởi các gói của Debian, hoặc được sinh ra bởi các tệp tin cấu hình không đưọc quản lý bởi <span class="command"><strong>dpkg</strong></span>, etc.).
			</p>
			 <p>
				Hãy thận trọng để không nhắm mắt mọi thứ mà <span class="command"><strong>cruft</strong></span> có thể liệt kê ra!
			</p>
			 </div>
		</section>
		 <section class="section" id="id-1.6.5.7"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="id-1.6.5.7"/>3.2.4. Cài đặt Debian</h3></div></div></div>
			
			 <p>
				Một khi là tất cả các thông tin cần thiết trên server hiện tại đã được biết, chúng ta có thể tắt máy và bắt đầu quá trình cài đặt Debian trên nó.
			</p>
			 <a id="id-1.6.5.7.3" class="indexterm"></a>
			 <p>
				Để lựa chọn được phiên bản thích hợp, chúng ta phải biết được kiến trúc của phần cứng. Với các máy tính hiện nay, chúng hầu như là amd64 (các máy tính cũ thường là i386). Trong trường hợp khác, chúng ta có thể thu hẹp các khả năng tùy theo các hệ thống đã sử dụng trước đó.
			</p>
			 <p>
				<a class="xref" href="sect.how-to-migrate.html#tab-corresp" title="Bảng 3.1. Hệ điều hành và kiến trúc tương xứng">Bảng 3.1</a> không nhắm tới mọi khía cạnh, nhưng có thể khá hữu ích. Trong bất kỳ trường hợp nào, các tài liệu thông thường dành cho máy tính là các nguồn đáng tin cậy để tìm kiếm thông tin này.
			</p>
			 <div class="table" id="tab-corresp"><a xmlns="" id="tab-corresp"/><p class="title"><strong>Bảng 3.1. Hệ điều hành và kiến trúc tương xứng</strong></p><div class="table-contents">
				
				 <table class="lt-4-cols lt-7-rows"><colgroup><col/><col/></colgroup><thead><tr><th>Hệ điều hành</th><th>Kiến trúc</th></tr></thead><tbody><tr><td>DEC Unix (OSF/1)</td><td>alpha, mipsel</td></tr><tr><td>HP Unix</td><td>ia64, hppa</td></tr><tr><td>IBM AIX</td><td>powerpc</td></tr><tr><td>Irix</td><td>mips</td></tr><tr><td>OS X</td><td>amd64, powerpc, i386</td></tr><tr><td>z/OS, MVS</td><td>s390x, s390</td></tr><tr><td>Solaris, SunOS</td><td>sparc, i386, m68k</td></tr><tr><td>Ultrix</td><td>mips</td></tr><tr><td>VMS</td><td>alpha</td></tr><tr><td>Windows 95/98/ME</td><td>i386</td></tr><tr><td>Windows NT/2000</td><td>i386, alpha, ia64, mipsel</td></tr><tr><td>Windows XP / Windows Server 2008</td><td>i386, amd64, ia64</td></tr><tr><td>Windows Vista / Windows 7 / Windows 8</td><td>i386, amd64</td></tr></tbody></table>

			</div></div>
			 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>HARDWARE</em></span> 64 bit PC vs 32 bit PC</strong></p></div></div></div> 
			 <a id="id-1.6.5.7.7.2" class="indexterm"></a>
			 <a id="id-1.6.5.7.7.3" class="indexterm"></a>
			 <p>
				Phần lớn các máy tính hiện nay có bộ xử lý 64 bit Intel hoặc AMD, tương thích với bộ xử lý 32bit trở lên; vậy nên các phần mềm biên dịch dành cho kiến trúc “i386” vẫn hoạt động. Mặt khác, chế độ tương thích này không khai thác hết các khả năng của các bộ vi xử lý mới. Điều này lý giải tại sao Debian cung cấp kiến trúc “amd64”, nó cũng hoạt động trên dòng chíp AMD hiện nay cũng như vi xử lý Intel “em64t” (bao gồm hầu hết các dòng Core), tương tự như AMD64.
			</p>
			 </div>
		</section>
		 <section class="section" id="id-1.6.5.8"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="id-1.6.5.8"/>3.2.5. Quá trình cài đặt và cấu hình các dịch vụ đã lựa chọn</h3></div></div></div>
			
			 <p>
				Khi Debian đã được cài đặt, chúng ta phải cài đặt và cấu hình từng cái một cho tất cả dịch vụ mà máy tính cần phải có. Các cấu hình mới phải được xem xét trước khi đưa vào để quá trình chuyển đổi được trơn tru. Mọi thông tin đã thu thập được trong hai bước trước sẽ hữu ích để hoàn thành phần này.
			</p>
			 <div class="figure" id="id-1.6.5.8.3"><a id="id-1.6.5.8.3"/><p class="title"><strong>Hình 3.3. Cài đặt các dịch vụ đã lựa chọn</strong></p><div class="figure-contents">
				
				 <div class="mediaobject"><img src="images/existing-setup-4.png" alt="Cài đặt các dịch vụ đã lựa chọn"/></div>

			</div></div>
			 <p>
				Chú ý, trước khi chuyển hoàn toàn sang phần thực hành, bạn nên đọc các phần còn lại của cuốn sách này. Sau đó bạn sẽ có một hiểu biết rộng hơn về làm sao để cấu hình được các dịch vụ như mong đợi.
			</p>
			 <p>
			</p>

		</section>

	</section><footer/></body></html>