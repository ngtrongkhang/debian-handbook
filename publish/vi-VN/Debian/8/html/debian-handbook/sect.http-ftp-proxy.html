<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>11.6. HTTP/FTP Proxy</title><meta name="generator" content="publican v4.3.2"/><meta name="keywords" content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP"/><link rel="prev" href="sect.windows-file-server-with-samba.html" title="11.5. Cài đặt các chia sẻ Windows với Samba"/><link rel="next" href="sect.ldap-directory.html" title="11.7. LDAP Directory"/><link xmlns="" rel="canonical" href="https://debian-handbook.info/browse/vi-VN/stable/sect.http-ftp-proxy.html"/></head><body onLoad="initSwitchery(); jQuery(&quot;#poptoc&quot;).load('index.html .toc:eq(0)'); jQuery('.programlisting').each(function(i, block){hljs.highlightBlock(block);});" onClick="hide('poptoc');"><header><div id="banner"><a href="http://debian-handbook.info/get/"><span class="text">Download the ebook</span></a></div><ul class="docnav top"><li class="previous"><a accesskey="p" href="sect.windows-file-server-with-samba.html"><strong>Trước đó</strong></a></li><li class="home" onClick="work=1;showhide('poptoc');">Sổ tay Quản trị Debian</li><li class="next"><a accesskey="n" href="sect.ldap-directory.html"><strong>Kế tiếp</strong></a></li></ul></header><div id="poptoc" class="hidden"> </div><section class="section" id="sect.http-ftp-proxy"><div class="titlepage"><div><div><h2 class="title"><a xmlns="" id="sect.http-ftp-proxy"/>11.6. HTTP/FTP Proxy</h2></div></div></div>
		
		 <p>
			An HTTP/FTP proxy acts as an intermediary for HTTP and/or FTP connections. Its role is twofold:
		</p>
		 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
				<p>
					Caching: recently downloaded documents are copied locally, which avoids multiple downloads.
				</p>

			</li><li class="listitem">
				<p>
					Filtering server: if use of the proxy is mandated (and outgoing connections are blocked unless they go through the proxy), then the proxy can determine whether or not the request is to be granted.
				</p>

			</li></ul></div>
		 <a id="id-1.14.9.4" class="indexterm"></a>
		 <a id="id-1.14.9.5" class="indexterm"></a>
		 <p>
			Falcot Corp selected Squid as their proxy server.
		</p>
		 <a id="id-1.14.9.7" class="indexterm"></a>
		 <section class="section" id="id-1.14.9.8"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="id-1.14.9.8"/>11.6.1. Installing</h3></div></div></div>
			
			 <p>
				The <span class="pkg pkg">squid3</span> Debian package only contains the modular (caching) proxy. Turning it into a filtering server requires installing the additional <span class="pkg pkg">squidguard</span> package. In addition, <span class="pkg pkg">squid-cgi</span> provides a querying and administration interface for a Squid proxy.
			</p>
			 <p>
				Prior to installing, care should be taken to check that the system can identify its own complete name: the <span class="command"><strong>hostname -f</strong></span> must return a fully-qualified name (including a domain). If it does not, then the <code class="filename">/etc/hosts</code> file should be edited to contain the full name of the system (for instance, <code class="literal">arrakis.falcot.com</code>). The official computer name should be validated with the network administrator in order to avoid potential name conflicts.
			</p>

		</section>
		 <section class="section" id="id-1.14.9.9"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="id-1.14.9.9"/>11.6.2. Configuring a Cache</h3></div></div></div>
			
			 <p>
				Enabling the caching server feature is a simple matter of editing the <code class="filename">/etc/squid3/squid.conf</code> configuration file and allowing machines from the local network to run queries through the proxy. The following example shows the modifications made by the Falcot Corp administrators:
			</p>
			 <div class="example" id="id-1.14.9.9.3"><a xmlns="" id="id-1.14.9.9.3"/><p class="title"><strong>Ví dụ 11.25. The <code class="filename">/etc/squid3/squid.conf</code> file (excerpts)</strong></p><div class="example-contents">
				
				 
<pre class="programlisting">
# INSERT YOUR OWN RULE(S) HERE TO ALLOW ACCESS FROM YOUR CLIENTS

# Example rule allowing access from your local networks. Adapt
# to list your (internal) IP networks from where browsing should
# be allowed
acl our_networks src 192.168.1.0/24 192.168.2.0/24
http_access allow our_networks
http_access allow localhost
# And finally deny all other access to this proxy
http_access deny all
</pre>

			</div></div>

		</section>
		 <section class="section" id="id-1.14.9.10"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="id-1.14.9.10"/>11.6.3. Configuring a Filter</h3></div></div></div>
			
			 <p>
				<span class="command"><strong>squid</strong></span> itself does not perform the filtering; this action is delegated to <span class="command"><strong>squidGuard</strong></span>. The former must then be configured to interact with the latter. This involves adding the following directive to the <code class="filename">/etc/squid3/squid.conf</code> file:
			</p>
			 <a id="id-1.14.9.10.3" class="indexterm"></a>
			 
<pre class="programlisting">
url_rewrite_program /usr/bin/squidGuard -c /etc/squid3/squidGuard.conf
</pre>
			 <p>
				The <code class="filename">/usr/lib/cgi-bin/squidGuard.cgi</code> CGI program also needs to be installed, using <code class="filename">/usr/share/doc/squidguard/examples/squidGuard.cgi.gz</code> as a starting point. Required modifications to this script are the <code class="varname">$proxy</code> and <code class="varname">$proxymaster</code> variables (the name of the proxy and the administrator's contact e-mail, respectively). The <code class="varname">$image</code> and <code class="varname">$redirect</code> variables should point to existing images representing the rejection of a query.
			</p>
			 <p>
				The filter is enabled with the <span class="command"><strong>service squid3 reload</strong></span> command. However, since the <span class="pkg pkg">squidguard</span> package does no filtering by default, it is the administrator's task to define the policy. This can be done by creating the <code class="filename">/etc/squid3/squidGuard.conf</code> file (using <code class="filename">/etc/squidguard/squidGuard.conf.default</code> as template if required).
			</p>
			 <p>
				The working database must be regenerated with <span class="command"><strong>update-squidguard</strong></span> after each change of the <span class="command"><strong>squidGuard</strong></span> configuration file (or one of the lists of domains or URLs it mentions). The configuration file syntax is documented on the following website: <a class="ulink" href="http://www.squidguard.org/Doc/configure.html">http://www.squidguard.org/Doc/configure.html</a>
			</p>
			 <a id="id-1.14.9.10.8" class="indexterm"></a>
			 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>ALTERNATIVE</em></span> DansGuardian</strong></p></div></div></div> 
			 <a id="id-1.14.9.10.9.2" class="indexterm"></a>
			 <a id="id-1.14.9.10.9.3" class="indexterm"></a>
			 <p>
				The <span class="pkg pkg">dansguardian</span> package is an alternative to <span class="emphasis"><em>squidguard</em></span>. This software does not simply handle a blacklist of forbidden URLs, but it can take advantage of the PICS system (<span class="emphasis"><em>Platform for Internet Content Selection</em></span>) to decide whether a page is acceptable by dynamic analysis of its contents.
			</p>
			 </div>
		</section>

	</section><footer/></body></html>