<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head><title>14.3. Supervision: Prevention, Detection, Deterrence</title><meta name="generator" content="publican v4.3.2"/><meta name="keywords" content="Tường lửa, Netfilter, IDS/NIDS"/><link rel="prev" href="sect.firewall-packet-filtering.html" title="14.2. Tường lửa hoặc bộ lọc gói dữ liệu."/><link rel="next" href="sect.apparmor.html" title="14.4. Introduction to AppArmor"/><link xmlns="" rel="canonical" href="https://debian-handbook.info/browse/vi-VN/stable/sect.supervision.html"/></head><body onLoad="initSwitchery(); jQuery(&quot;#poptoc&quot;).load('index.html .toc:eq(0)'); jQuery('.programlisting').each(function(i, block){hljs.highlightBlock(block);});" onClick="hide('poptoc');"><header><div id="banner"><a href="http://debian-handbook.info/get/"><span class="text">Download the ebook</span></a></div><ul class="docnav top"><li class="previous"><a accesskey="p" href="sect.firewall-packet-filtering.html"><strong>Trước đó</strong></a></li><li class="home" onClick="work=1;showhide('poptoc');">Sổ tay Quản trị Debian</li><li class="next"><a accesskey="n" href="sect.apparmor.html"><strong>Kế tiếp</strong></a></li></ul></header><div id="poptoc" class="hidden"> </div><section class="section" id="sect.supervision"><div class="titlepage"><div><div><h2 class="title"><a xmlns="" id="sect.supervision"/>14.3. Supervision: Prevention, Detection, Deterrence</h2></div></div></div>
		
		 <a id="id-1.17.6.2" class="indexterm"></a>
		 <p>
			Monitoring is an integral part of any security policy for several reasons. Among them, that the goal of security is usually not restricted to guaranteeing data confidentiality, but it also includes ensuring availability of the services. It is therefore imperative to check that everything works as expected, and to detect in a timely manner any deviant behavior or change in quality of the service(s) rendered. Monitoring activity can help detecting intrusion attempts and enable a swift reaction before they cause grave consequences. This section reviews some tools that can be used to monitor several aspects of a Debian system. As such, it completes <a class="xref" href="sect.monitoring.html" title="12.4. Monitoring">Phần 12.4, “Monitoring”</a>.
		</p>
		 <section class="section" id="sect.logcheck"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="sect.logcheck"/>14.3.1. Monitoring Logs with <span class="command"><strong>logcheck</strong></span></h3></div></div></div>
			
			 <a id="id-1.17.6.4.2" class="indexterm"></a>
			 <a id="id-1.17.6.4.3" class="indexterm"></a>
			 <a id="id-1.17.6.4.4" class="indexterm"></a>
			 <p>
				The <span class="command"><strong>logcheck</strong></span> program monitors log files every hour by default. It sends unusual log messages in emails to the administrator for further analysis.
			</p>
			 <p>
				The list of monitored files is stored in <code class="filename">/etc/logcheck/logcheck.logfiles</code>; the default values work fine if the <code class="filename">/etc/rsyslog.conf</code> file has not been completely overhauled.
			</p>
			 <p>
				<span class="command"><strong>logcheck</strong></span> can work in one of three more or less detailed modes: <span class="emphasis"><em>paranoid</em></span>, <span class="emphasis"><em>server</em></span> and <span class="emphasis"><em>workstation</em></span>. The first one is <span class="emphasis"><em>very</em></span> verbose, and should probably be restricted to specific servers such as firewalls. The second (and default) mode is recommended for most servers. The last one is designed for workstations, and is even terser (it filters out more messages).
			</p>
			 <p>
				In all three cases, <span class="command"><strong>logcheck</strong></span> should probably be customized to exclude some extra messages (depending on installed services), unless the admin really wishes to receive hourly batches of long uninteresting emails. Since the message selection mechanism is rather complex, <code class="filename">/usr/share/doc/logcheck-database/README.logcheck-database.gz</code> is a required — if challenging — read.
			</p>
			 <p>
				The applied rules can be split into several types:
			</p>
			 <div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<p>
						those that qualify a message as a cracking attempt (stored in a file in the <code class="filename">/etc/logcheck/cracking.d/</code> directory);
					</p>

				</li><li class="listitem">
					<p>
						those canceling such a qualification (<code class="filename">/etc/logcheck/cracking.ignore.d/</code>);
					</p>

				</li><li class="listitem">
					<p>
						those classifying a message as a security alert (<code class="filename">/etc/logcheck/violations.d/</code>);
					</p>

				</li><li class="listitem">
					<p>
						those canceling this classification (<code class="filename">/etc/logcheck/violations.ignore.d/</code>);
					</p>

				</li><li class="listitem">
					<p>
						finally, those applying to the remaining messages (considered as <span class="emphasis"><em>system events</em></span>).
					</p>

				</li></ul></div>
			 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>CAUTION</em></span> Ignoring a message</strong></p></div></div></div> 
			 <p>
				Any message tagged as a cracking attempt or a security alert (following a rule stored in a <code class="filename">/etc/logcheck/violations.d/myfile</code> file) can only be ignored by a rule in a <code class="filename">/etc/logcheck/violations.ignore.d/myfile</code> or <code class="filename">/etc/logcheck/violations.ignore.d/myfile-<em class="replaceable">extension</em></code> file.
			</p>
			 </div> <p>
				A system event is always signaled unless a rule in one of the <code class="filename">/etc/logcheck/ignore.d.{paranoid,server,workstation}/</code> directories states the event should be ignored. Of course, the only directories taken into account are those corresponding to verbosity levels equal or greater than the selected operation mode.
			</p>

		</section>
		 <section class="section" id="sect.monitoring-activity"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="sect.monitoring-activity"/>14.3.2. Monitoring Activity</h3></div></div></div>
			
			 <a id="id-1.17.6.5.2" class="indexterm"></a>
			 <a id="id-1.17.6.5.3" class="indexterm"></a>
			 <section class="section" id="sect.real-time-monitoring"><div class="titlepage"><div><div><h4 class="title"><a xmlns="" id="sect.real-time-monitoring"/>14.3.2.1. In Real Time</h4></div></div></div>
				
				 <p>
					<span class="command"><strong>top</strong></span> is an interactive tool that displays a list of currently running processes. The default sorting is based on the current amount of processor use and can be obtained with the <span class="keycap"><strong>P</strong></span> key. Other sort orders include a sort by occupied memory (<span class="keycap"><strong>M</strong></span> key), by total processor time (<span class="keycap"><strong>T</strong></span> key) and by process identifier (<span class="keycap"><strong>N</strong></span> key). The <span class="keycap"><strong>k</strong></span> key allows killing a process by entering its process identifier. The <span class="keycap"><strong>r</strong></span> key allows <span class="emphasis"><em>renicing</em></span> a process, i.e. changing its priority.
				</p>
				 <a id="id-1.17.6.5.4.3" class="indexterm"></a>
				 <p>
					When the system seems to be overloaded, <span class="command"><strong>top</strong></span> is a great tool to see which processes are competing for processor time or consume too much memory. In particular, it is often interesting to check if the processes consuming resources match the real services that the machine is known to host. An unknown process running as the www-data user should really stand out and be investigated, since it's probably an instance of software installed and executed on the system through a vulnerability in a web application.
				</p>
				 <p>
					<span class="command"><strong>top</strong></span> is a very flexible tool and its manual page gives details on how to customize its display and adapt it to one's personal needs and habits.
				</p>
				 <p>
					The <span class="command"><strong>gnome-system-monitor</strong></span> graphical tool is similar to <span class="command"><strong>top</strong></span> and it provides roughly the same features.
				</p>
				 <a id="id-1.17.6.5.4.7" class="indexterm"></a>

			</section>
			 <section class="section" id="sect.monitoring-history"><div class="titlepage"><div><div><h4 class="title"><a xmlns="" id="sect.monitoring-history"/>14.3.2.2. History</h4></div></div></div>
				
				 <a id="id-1.17.6.5.5.2" class="indexterm"></a>
				 <p>
					Processor load, network traffic and free disk space are information that are constantly varying. Keeping a history of their evolution is often useful in determining exactly how the computer is used.
				</p>
				 <a id="id-1.17.6.5.5.4" class="indexterm"></a>
				 <a id="id-1.17.6.5.5.5" class="indexterm"></a>
				 <p>
					There are many dedicated tools for this task. Most can fetch data via SNMP (<span class="emphasis"><em>Simple Network Management Protocol</em></span>) in order to centralize this information. An added benefit is that this allows fetching data from network elements that may not be general-purpose computers, such as dedicated network routers or switches.
				</p>
				 <p>
					This book deals with Munin in some detail (see <a class="xref" href="sect.monitoring.html#sect.munin" title="12.4.1. Setting Up Munin">Phần 12.4.1, “Setting Up Munin”</a>) as part of <a class="xref" href="advanced-administration.html" title="Chương 12. Advanced Administration">Chương 12: “<em>Advanced Administration</em>”</a>. Debian also provides a similar tool, <span class="pkg pkg">cacti</span>. Its deployment is slightly more complex, since it is based solely on SNMP. Despite having a web interface, grasping the concepts involved in configuration still requires some effort. Reading the HTML documentation (<code class="filename">/usr/share/doc/cacti/html/index.html</code>) should be considered a prerequisite.
				</p>
				 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>ALTERNATIVE</em></span> <span class="command"><strong>mrtg</strong></span></strong></p></div></div></div> 
				 <a id="id-1.17.6.5.5.8.2" class="indexterm"></a>
				 <p>
					<span class="command"><strong>mrtg</strong></span> (in the similarly-named package) is an older tool. Despite some rough edges, it can aggregate historical data and display them as graphs. It includes a number of scripts dedicated to collecting the most commonly monitored data such as processor load, network traffic, web page hits, and so on.
				</p>
				 <p>
					The <span class="pkg pkg">mrtg-contrib</span> and <span class="pkg pkg">mrtgutils</span> packages contain example scripts that can be used directly.
				</p>
				 </div>
			</section>

		</section>
		 <section class="section" id="id-1.17.6.6"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="id-1.17.6.6"/>14.3.3. Detecting Changes</h3></div></div></div>
			
			 <p>
				Once the system is installed and configured, and barring security upgrades, there's usually no reason for most of the files and directories to evolve, data excepted. It is therefore interesting to make sure that files actually do not change: any unexpected change would therefore be worth investigating. This section presents a few tools able to monitor files and to warn the administrator when an unexpected change occurs (or simply to list such changes).
			</p>
			 <section class="section" id="sect.dpkg-verify"><div class="titlepage"><div><div><h4 class="title"><a xmlns="" id="sect.dpkg-verify"/>14.3.3.1. Auditing Packages with <span class="command"><strong>dpkg --verify</strong></span></h4></div></div></div>
				
				 <a id="id-1.17.6.6.3.2" class="indexterm"></a>
				 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>GOING FURTHER</em></span> Protecting against upstream changes</strong></p></div></div></div> 
				 <p>
					<span class="command"><strong>dpkg --verify</strong></span> is useful in detecting changes to files coming from a Debian package, but it will be useless if the package itself is compromised, for instance if the Debian mirror is compromised. Protecting against this class of attacks involves using APT's digital signature verification system (see <a class="xref" href="sect.package-authentication.html" title="6.5. Kiểm tra Tính xác thực Gói">Phần 6.5, “Kiểm tra Tính xác thực Gói”</a>), and taking care to only install packages from a certified origin.
				</p>
				 </div> <p>
					<span class="command"><strong>dpkg --verify</strong></span> (or <span class="command"><strong>dpkg -V</strong></span>) is an interesting tool since it allows finding what installed files have been modified (potentially by an attacker), but this should be taken with a grain of salt. To do its job it relies on checksums stored in dpkg's own database which is stored on the hard disk (they can be found in <code class="filename">/var/lib/dpkg/info/<em class="replaceable">package</em>.md5sums</code>); a thorough attacker will therefore update these files so they contain the new checksums for the subverted files.
				</p>
				 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>BACK TO BASICS</em></span> File fingerprint</strong></p></div></div></div> 
				 <a id="id-1.17.6.6.3.5.2" class="indexterm"></a>
				 <a id="id-1.17.6.6.3.5.3" class="indexterm"></a>
				 <a id="id-1.17.6.6.3.5.4" class="indexterm"></a>
				 <a id="id-1.17.6.6.3.5.5" class="indexterm"></a>
				 <p>
					As a reminder: a fingerprint is a value, often a number (even though in hexadecimal notation), that contains a kind of signature for the contents of a file. This signature is calculated with an algorithm (MD5 or SHA1 being well-known examples) that more or less guarantee that even the tiniest change in the file contents implies a change in the fingerprint; this is known as the “avalanche effect”. This allows a simple numerical fingerprint to serve as a litmus test to check whether the contents of a file have been altered. These algorithms are not reversible; in other words, for most of them, knowing a fingerprint doesn't allow finding the corresponding contents. Recent mathematical advances seem to weaken the absoluteness of these principles, but their use is not called into question so far, since creating different contents yielding the same fingerprint still seems to be quite a difficult task.
				</p>
				 </div> <p>
					Running <span class="command"><strong>dpkg -V</strong></span> will verify all installed packages and will print out a line for each file with a failing test. The output format is the same as the one of <span class="command"><strong>rpm -V</strong></span> where each character denotes a test on some specific meta-data. Unfortunately <span class="command"><strong>dpkg</strong></span> does not store the meta-data needed for most tests and will thus output question marks for them. Currently only the checksum test can yield a "5" on the third character (when it fails).
				</p>
				 
<pre class="screen">
<code class="computeroutput"># </code><strong class="userinput"><code>dpkg -V</code></strong>
<code class="computeroutput">??5?????? /lib/systemd/system/ssh.service ??5?????? c /etc/libvirt/qemu/networks/default.xml ??5?????? c /etc/lvm/lvm.conf ??5?????? c /etc/salt/roster</code></pre>
				 <p>
					In the sample above, dpkg reports a change to SSH's service file that the administrator made to the packaged file instead of using an appropriate <code class="filename">/etc/systemd/system/ssh.service</code> override (which would be stored below <code class="filename">/etc</code> like any configuration change should be). It also lists multiple configuration files (identified by the "c" letter on the second field) that had been legitimately modified.
				</p>

			</section>
			 <section class="section" id="sect.debsums"><div class="titlepage"><div><div><h4 class="title"><a xmlns="" id="sect.debsums"/>14.3.3.2. Auditing Packages: <span class="command"><strong>debsums</strong></span> and its Limits</h4></div></div></div>
				
				 <a id="id-1.17.6.6.4.2" class="indexterm"></a>
				 <p>
					<span class="command"><strong>debsums</strong></span> is the ancestor of <span class="command"><strong>dpkg -V</strong></span> and is thus mostly obsolete. It suffers from the same limitations than dpkg. Fortunately, some of the limitations can be worked-around (whereas dpkg does not offer similar work-arounds).
				</p>
				 <p>
					Since the data on the disk cannot be trusted, <span class="command"><strong>debsums</strong></span> offers to do its checks based on <code class="filename">.deb</code> files instead of relying on dpkg's database. To download trusted <code class="filename">.deb</code> files of all the packages installed, we can rely on APT's authenticated downloads. This operation can be slow and tedious, and should therefore not be considered a proactive technique to be used on a regular basis.
				</p>
				 
<pre class="screen">
<code class="computeroutput"># </code><strong class="userinput"><code>apt-get --reinstall -d install `grep-status -e 'Status: install ok installed' -n -s Package`</code></strong>
<code class="computeroutput">[ ... ] # </code><strong class="userinput"><code>debsums -p /var/cache/apt/archives --generate=all</code></strong></pre>
				 <p>
					Note that this example uses the <span class="command"><strong>grep-status</strong></span> command from the <span class="pkg pkg">dctrl-tools</span> package, which is not installed by default.
				</p>

			</section>
			 <section class="section" id="id-1.17.6.6.5"><div class="titlepage"><div><div><h4 class="title"><a xmlns="" id="id-1.17.6.6.5"/>14.3.3.3. Monitoring Files: AIDE</h4></div></div></div>
				
				 <a id="id-1.17.6.6.5.2" class="indexterm"></a>
				 <p>
					The AIDE tool (<span class="emphasis"><em>Advanced Intrusion Detection Environment</em></span>) allows checking file integrity, and detecting any change against a previously recorded image of the valid system. This image is stored as a database (<code class="filename">/var/lib/aide/aide.db</code>) containing the relevant information on all files of the system (fingerprints, permissions, timestamps and so on). This database is first initialized with <span class="command"><strong>aideinit</strong></span>; it is then used daily (by the <code class="filename">/etc/cron.daily/aide</code> script) to check that nothing relevant changed. When changes are detected, AIDE records them in log files (<code class="filename">/var/log/aide/*.log</code>) and sends its findings to the administrator by email.
				</p>
				 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>IN PRACTICE</em></span> Protecting the database</strong></p></div></div></div> 
				 <p>
					Since AIDE uses a local database to compare the states of the files, the validity of its results is directly linked to the validity of the database. If an attacker gets root permissions on a compromised system, they will be able to replace the database and cover their tracks. A possible workaround would be to store the reference data on read-only storage media.
				</p>
				 </div> <p>
					Many options in <code class="filename">/etc/default/aide</code> can be used to tweak the behavior of the <span class="pkg pkg">aide</span> package. The AIDE configuration proper is stored in <code class="filename">/etc/aide/aide.conf</code> and <code class="filename">/etc/aide/aide.conf.d/</code> (actually, these files are only used by <span class="command"><strong>update-aide.conf</strong></span> to generate <code class="filename">/var/lib/aide/aide.conf.autogenerated</code>). Configuration indicates which properties of which files need to be checked. For instance, the contents of log files changes routinely, and such changes can be ignored as long as the permissions of these files stay the same, but both contents and permissions of executable programs must be constant. Although not very complex, the configuration syntax is not fully intuitive, and reading the <span class="citerefentry"><span class="refentrytitle">aide.conf</span>
					 (5)</span> manual page is therefore recommended.
				</p>
				 <p>
					A new version of the database is generated daily in <code class="filename">/var/lib/aide/aide.db.new</code>; if all recorded changes were legitimate, it can be used to replace the reference database.
				</p>
				 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>ALTERNATIVE</em></span> Tripwire and Samhain</strong></p></div></div></div> 
				 <p>
					Tripwire is very similar to AIDE; even the configuration file syntax is almost the same. The main addition provided by <span class="pkg pkg">tripwire</span> is a mechanism to sign the configuration file, so that an attacker cannot make it point at a different version of the reference database.
				</p>
				 <p>
					Samhain also offers similar features, as well as some functions to help detecting rootkits (see the sidebar <a class="xref" href="sect.supervision.html#sidebar.the-checksecurity-and-chkrootkit-rkhunter-packages" title="QUICK LOOK The checksecurity and chkrootkit/rkhunter packages"><span class="emphasis"><em>QUICK LOOK</em></span> The <span class="pkg pkg">checksecurity</span> and <span class="pkg pkg">chkrootkit</span>/<span class="pkg pkg">rkhunter</span> packages</a>). It can also be deployed globally on a network, and record its traces on a central server (with a signature).
				</p>
				 </div> <div class="sidebar" id="sidebar.the-checksecurity-and-chkrootkit-rkhunter-packages"><a xmlns="" id="sidebar.the-checksecurity-and-chkrootkit-rkhunter-packages"/><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>QUICK LOOK</em></span> The <span class="pkg pkg">checksecurity</span> and <span class="pkg pkg">chkrootkit</span>/<span class="pkg pkg">rkhunter</span> packages</strong></p></div></div></div> 
				 <a id="id-1.17.6.6.5.8.2" class="indexterm"></a>
				 <p>
					The first of these packages contains several small scripts performing basic checks on the system (empty passwords, new setuid files, and so on) and warning the administrator if required. Despite its explicit name, an administrator should not rely solely on it to make sure a Linux system is secure.
				</p>
				 <p>
					The <span class="pkg pkg">chkrootkit</span> and <span class="pkg pkg">rkhunter</span> packages allow looking for <span class="emphasis"><em>rootkits</em></span> potentially installed on the system. As a reminder, these are pieces of software designed to hide the compromise of a system while discreetly keeping control of the machine. The tests are not 100% reliable, but they can usually draw the administrator's attention to potential problems.
				</p>
				 </div>
			</section>

		</section>
		 <section class="section" id="sect.intrusion-detection"><div class="titlepage"><div><div><h3 class="title"><a xmlns="" id="sect.intrusion-detection"/>14.3.4. Detecting Intrusion (IDS/NIDS)</h3></div></div></div>
			
			 <a id="id-1.17.6.7.2" class="indexterm"></a>
			 <a id="id-1.17.6.7.3" class="indexterm"></a>
			 <a id="id-1.17.6.7.4" class="indexterm"></a>
			 <a id="id-1.17.6.7.5" class="indexterm"></a>
			 <a id="id-1.17.6.7.6" class="indexterm"></a>
			 <a id="id-1.17.6.7.7" class="indexterm"></a>
			 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>BACK TO BASICS</em></span> Denial of service</strong></p></div></div></div> 
			 <a id="id-1.17.6.7.8.2" class="indexterm"></a>
			 <p>
				A “denial of service” attack has only one goal: to make a service unavailable. Whether such an attack involves overloading the server with queries or exploiting a bug, the end result is the same: the service is no longer operational. Regular users are unhappy, and the entity hosting the targeted network service suffers a loss in reputation (and possibly in revenue, for instance if the service was an e-commerce site).
			</p>
			 <p>
				Such an attack is sometimes “distributed”; this usually involves overloading the server with large numbers of queries coming from many different sources so that the server becomes unable to answer the legitimate queries. These types of attacks have gained well-known acronyms: <abbr class="acronym">DDoS</abbr> and <abbr class="acronym">DoS</abbr> (depending on whether the denial of service attack is distributed or not).
			</p>
			 </div> <p>
				<span class="command"><strong>suricata</strong></span> (in the Debian package of the same name) is a NIDS — a <span class="emphasis"><em>Network Intrusion Detection System</em></span>. Its function is to listen to the network and try to detect infiltration attempts and/or hostile acts (including denial of service attacks). All these events are logged in multiple files in <code class="filename">/var/log/suricata</code>. There are third party tools (Kibana/logstash) to better browse all the data collected. <a class="ulink" href="http://suricata-ids.org">http://suricata-ids.org</a> <a class="ulink" href="https://www.elastic.co/products/kibana">https://www.elastic.co/products/kibana</a>
			</p>
			 <a id="id-1.17.6.7.10" class="indexterm"></a>
			 <a id="id-1.17.6.7.11" class="indexterm"></a>
			 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>CAUTION</em></span> Range of action</strong></p></div></div></div> 
			 <p>
				The effectiveness of <span class="command"><strong>suricata</strong></span> is limited by the traffic seen on the monitored network interface. It will obviously not be able to detect anything if it cannot observe the real traffic. When plugged into a network switch, it will therefore only monitor attacks targeting the machine it runs on, which is probably not the intention. The machine hosting <span class="command"><strong>suricata</strong></span> should therefore be plugged into the “mirror” port of the switch, which is usually dedicated to chaining switches and therefore gets all the traffic.
			</p>
			 </div> <p>
				Configuring suricata involves reviewing and editing <code class="filename">/etc/suricata/suricata-debian.yaml</code>, which is very long because each parameter is abundantly commented. A minimal configuration requires describing the range of addresses that the local network covers (<code class="literal">HOME_NET</code> parameter). In practice, this means the set of all potential attack targets. But getting the most of it requires reading it in full and adapting it to the local situation.
			</p>
			 <p>
				On top of this, you should also edit <code class="filename">/etc/default/suricata</code> to define the network interface to monitor and to enable the init script (by setting <code class="literal">RUN=yes</code>). You might also want to set <code class="literal">LISTENMODE=pcap</code> because the default <code class="literal">LISTENMODE=nfqueue</code> requires further configuration to work properly (the netfilter firewall must be configured to pass packets to some user-space queue handled by suricata via the <code class="literal">NFQUEUE</code> target).
			</p>
			 <p>
				To detect bad behaviour, <span class="command"><strong>suricata</strong></span> needs a set of monitoring rules: you can find such rules in the <span class="pkg pkg">snort-rules-default</span> package. <span class="command"><strong>snort</strong></span> is the historical reference in the IDS ecosystem and <span class="command"><strong>suricata</strong></span> is able to reuse rules written for it. Unfortunately that package is missing from <span class="distribution distribution">Debian Jessie</span> and should be retrieved from another Debian release like <span class="distribution distribution">Testing</span> or <span class="distribution distribution">Unstable</span>.
			</p>
			 <p>
				Alternatively, <span class="command"><strong>oinkmaster</strong></span> (in the package of the same name) can be used to download Snort rulesets from external sources.
			</p>
			 <div class="sidebar"><div class="titlepage"><div><div><p class="title"><strong><span class="emphasis"><em>GOING FURTHER</em></span> Integration with <span class="command"><strong>prelude</strong></span></strong></p></div></div></div> 
			 <p>
				Prelude brings centralized monitoring of security information. Its modular architecture includes a server (the <span class="emphasis"><em>manager</em></span> in <span class="pkg pkg">prelude-manager</span>) which gathers alerts generated by <span class="emphasis"><em>sensors</em></span> of various types.
			</p>
			 <p>
				Suricata can be configured as such a sensor. Other possibilities include <span class="emphasis"><em>prelude-lml</em></span> (<span class="emphasis"><em>Log Monitor Lackey</em></span>) which monitors log files (in a manner similar to <span class="command"><strong>logcheck</strong></span>, described in <a class="xref" href="sect.supervision.html#sect.logcheck" title="14.3.1. Monitoring Logs with logcheck">Phần 14.3.1, “Monitoring Logs with <span class="command"><strong>logcheck</strong></span>”</a>).
			</p>
			 <a id="id-1.17.6.7.17.4" class="indexterm"></a>
			 </div>
		</section>

	</section><footer/></body></html>